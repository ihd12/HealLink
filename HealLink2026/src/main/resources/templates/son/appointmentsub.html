<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>병원 목록 - HealLink</title>
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/hospital/hospital.css}">
    <link rel="stylesheet" th:href="@{/css/mainpage/header.css}">
    <link rel="stylesheet" th:href="@{/css/mainpage/footer.css}">

</head>
<body>
<div th:replace="mainpage/header :: header"></div>

<main class="main-container">
    <h1 class="page-title">병원 목록</h1>

    <div style="text-align: right; margin-bottom: 20px;">
        <button type="button" class="btn-primary" id="openRegionModal">
            지역 선택
        </button>
    </div>

    <div th:if="${responseDTO != null and !responseDTO.dtoList.isEmpty()}">
        <div class="hospital-grid">
            <div class="hospital-card" th:each="hospital : ${responseDTO.dtoList}">

                <div class="card-info">
                    <div class="card-header-row">
                        <a th:href="@{/hospitals/{hpid}(hpid=${hospital.hpid})}" class="hospital-link">
                            <h3 class="hospital-name" th:text="${hospital.dutyName}">병원 이름</h3>
                        </a>
                        <span class="status-badge" th:if="${hospital.dutyEryn == 'Y'}"
                              style="color: #e03131; background-color: #fff5f5;">응급실운영</span>
                        <span class="status-badge" th:unless="${hospital.dutyEryn == 'Y'}">진료중</span>
                    </div>

                    <div class="card-meta">
                        <p class="hospital-addr" th:text="${hospital.dutyAddr}">주소</p>
                        <p class="hospital-phone" th:text="${hospital.dutyTel1}">전화번호</p>
                        <div class="hospital-tags">
                            <span th:if="${hospital.dutyDivNam != null}"
                                  th:text="'#' + ${hospital.dutyDivNam}">#과목</span>
                            <span th:if="${hospital.dutyAddr != null}"
                                  th:text="'#' + ${hospital.dutyAddr.split(' ')[1]}">#지역</span>
                        </div>
                    </div>

                    <div class="card-stats">
                        <span class="rating" th:with="randomRating=${T(java.lang.Math).random() * 2 + 3}">
                            ★ <span th:text="${#numbers.formatDecimal(randomRating, 1, 1)}">4.5</span>
                        </span>
                        <span class="review-count"
                              th:with="randomReview=${T(java.lang.Math).floor(T(java.lang.Math).random() * 490 + 10)}">
                            리뷰 <span th:text="${#numbers.formatInteger(randomReview, 0)}">120</span>+
                        </span>
                    </div>
                </div>

                <div class="card-image">
                    <a th:href="@{/hospitals/{hpid}(hpid=${hospital.hpid})}">
                        <img th:src="@{/images/hospital/default.jpg}" alt="병원 이미지">
                    </a>
                </div>
            </div>
        </div>
    </div>

</main>

<div th:replace="mainpage/footer :: footer"></div>

<div id="regionModalOverlay" class="modal-overlay">

    <div class="modal-container">
        <div class="modal-header">
            <h2>지역 선택</h2>
            <span id="closeRegionModal" class="close-btn">&times;</span>
        </div>

        <div class="path-nav">
            <span id="step1" class="path-item active">시/도</span>
            <span class="path-arrow">&gt;</span>
            <span id="step2" class="path-item">시/군/구</span>
            <span class="path-arrow">&gt;</span>
            <span id="step3" class="path-item">읍/면/동</span>
        </div>

        <div id="regionButtons" class="region-grid">
        </div>

        <div class="modal-footer">
            <button id="btnReset" class="btn-reset">초기화</button>
            <button id="btnConfirm" class="btn-confirm">지역을 선택해주세요</button>
        </div>

    </div>
</div>
<script th:src="@{/js/busan/BusanGuList.js}"></script>
<script th:src="@{/js/busan/region.js}"></script>

</body>
</html>
<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>공지사항 작성</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        .container { width: 600px; margin: 50px auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], textarea { width: 100%; padding: 8px; box-sizing: border-box; }
        textarea { height: 200px; }
        .btn-group { text-align: right; }
        button { padding: 10px 20px; cursor: pointer; }
        .btn-save { background-color: #007bff; color: white; border: none; }
    </style>
</head>
<body>

<div class="container">
    <h2>공지사항 작성</h2>
    <hr>

    <div class="form-group">
        <label for="title">제목</label>
        <input type="text" id="title" placeholder="제목을 입력하세요">
    </div>

    <div class="form-group">
        <label>
            <input type="checkbox" id="isPinned"> 상단 고정 여부
        </label>
    </div>

    <div class="form-group">
        <label for="content">내용</label>
        <textarea id="content" placeholder="내용을 입력하세요"></textarea>
    </div>

    <div class="btn-group">
        <button type="button" onclick="history.back()">취소</button>
        <button type="button" class="btn-save" onclick="saveNotice()">등록하기</button>
    </div>
</div>

<script>
    function saveNotice() {
        // 1. 입력값 가져오기
        const title = document.getElementById('title').value;
        const content = document.getElementById('content').value;
        const isPinned = document.getElementById('isPinned').checked;

        // 유효성 검사 (간단히)
        if (!title || !content) {
            alert("제목과 내용을 모두 입력해주세요.");
            return;
        }

        // 2. 서버로 보낼 데이터 구성 (NoticeAddRequest DTO 구조와 일치해야 함)
        const requestData = {
            title: title,
            content: content,
            isPinned: isPinned
        };

        // 3. Axios를 이용한 POST 요청
        // API 주소는 컨트롤러에서 설정한 @PostMapping 주소와 맞춰야 합니다.
        axios.post('/api/admin/notice', requestData)
            .then(response => {
                console.log("저장 성공:", response.data);
                alert("공지사항이 성공적으로 등록되었습니다.");
                location.href = "/admin/notice"; // 등록 후 목록 페이지로 이동
            })
            .catch(error => {
                console.error("저장 실패:", error);
                if (error.response) {
                    alert("에러 발생: " + error.response.data.message);
                } else {
                    alert("서버와 통신 중 문제가 발생했습니다.");
                }
            });
    }
</script>

</body>
</html>